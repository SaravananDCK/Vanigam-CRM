@page "/ChangePassword"
@using Vanigam.Accounting.Client.Validators
@attribute [Authorize(Policy = Vanigam.Accounting.Objects.ApplicationPolicy.IsAdministrator)]
@inject Microsoft.Extensions.Localization.IStringLocalizer<ChangePassword> Localizer
<PageTitle>@Localizer["Changepassword"]</PageTitle>
<RadzenStack>
    <RadzenRow AlignItems="AlignItems.Center">
        <RadzenColumn Size="12">
            <RadzenText Text=@Localizer["Changepassword"] TextStyle="TextStyle.H5" TagName="TagName.H1" Style="margin: 0" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow>
        <RadzenColumn SizeMD="12">
            <RadzenTemplateForm @ref=Form EditContext="EditContext" Method="post" Submit="@FormSubmit" TItem="ApplicationUser" Data="@User"
                                Visible="@(User != null)">
                <RadzenAlert Size="AlertSize.Large" Shade="Shade.Light" AlertStyle="AlertStyle.Danger" Variant="Variant.Flat" Title=@Localizer["CannotChangePassword"] Visible="@errorVisible">@error</RadzenAlert>               
                <FluentValidationValidator Validator="new ChangePasswordValidator(Localizer)" />
                <ValidationSummary />
                <RadzenStack Style="margin-bottom: 1rem;">
                    <VanigamAccountingFormField Text=@Localizer["OldPassword"] Variant="Variant.Outlined">
                        <ChildContent>
                            <RadzenPassword @bind-Value="@oldPassword" Style="display: block; width: 100%" Name="OldPassword" />
                        </ChildContent>
                        <Helper>
                            <RadzenRequiredValidator Component="OldPassword" Text=@Localizer["CurrentPassword"] />
                        </Helper>
                    </VanigamAccountingFormField>
                    <VanigamAccountingFormField Text=@Localizer["NewPassword"] Variant="Variant.Outlined">
                        <ChildContent>
                            <RadzenPassword @bind-Value="@newPassword" Style="display: block; width: 100%" Name="NewPassword" />
                        </ChildContent>
                        <Helper>
                            <RadzenRequiredValidator Component="NewPassword" Text=@Localizer["EnterNewPassword"] />
                        </Helper>
                    </VanigamAccountingFormField>
                    <VanigamAccountingFormField Text=@Localizer["ConfirmPassword"] Variant="Variant.Outlined">
                        <ChildContent>
                            <RadzenPassword @bind-Value="@confirmPassword" Style="display: block; width: 100%" Name="ConfirmPassword" />
                        </ChildContent>
                        <Helper>
                            <RadzenRequiredValidator Component="ConfirmPassword" Text=@Localizer["ConfirmNewPassword"] />
                            <RadzenCompareValidator Component="ConfirmPassword" Text=@Localizer["PasswordSame"] Value="@newPassword" />
                        </Helper>
                    </VanigamAccountingFormField>
                </RadzenStack>
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.End">
                    <VanigamAccountingSaveButton Id="btn_Changepassword" Text="@Localizer["Changepassword"]" Disabled="@(!(Form.EditContext.IsModified()))" @bind-IsBusy="IsBusy" />
                </RadzenStack>
            </RadzenTemplateForm>
        </RadzenColumn>
    </RadzenRow>
</RadzenStack>
